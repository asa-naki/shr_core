<?xml version="1.0"?>
<!--
ナビゲーション・自律走行用ランチファイル
LiDAR + モータコントローラ + ジョイスティックコントローラを起動
-->
<launch>
  <!-- Launch Arguments -->
  <arg name="use_sim_time" default="false" description="Use simulation time" />
  <arg name="motor_type" default="ddt" description="Motor controller type: ddt or esc" />
  <arg name="enable_rviz" default="true" description="Enable RViz visualization" />
  <arg name="joy_device" default="/dev/input/js0" description="Joystick device path" />

  <!-- YDLiDAR -->
  <include file="$(find-pkg-share ydlidar_ros2_driver)/launch/ydlidar_launch.xml" />

  <!-- Joy Controller -->
  <include file="$(find-pkg-share joy_controller)/launch/joy_controller.launch.xml">
    <arg name="use_sim_time" value="$(var use_sim_time)" />
    <arg name="joy_device" value="$(var joy_device)" />
  </include>

  <!-- DDT Motor Controller -->
  <node pkg="ddt_motor_control" exec="ddt_motor_controller_node.py" name="ddt_motor_controller" 
        output="screen" if="$(eval '\'$(var motor_type)\' == \'ddt\'')">
    <param name="use_sim_time" value="$(var use_sim_time)" />
  </node>

  <!-- ESC Motor Controller -->
  <group if="$(eval '\'$(var motor_type)\' == \'esc\'')">
    <include file="$(find-pkg-share esc_motor_control)/launch/esc_motor_control.launch.xml">
      <arg name="use_sim_time" value="$(var use_sim_time)" />
    </include>
  </group>

  <!-- RViz -->
  <node pkg="rviz2" exec="rviz2" name="rviz2" output="screen" if="$(var enable_rviz)"
        args="-d $(find-pkg-share ydlidar_ros2_driver)/config/ydlidar.rviz">
    <param name="use_sim_time" value="$(var use_sim_time)" />
  </node>

</launch>
